//SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract CarAnimation {
    function makeAnimation() public view returns (string memory animation) {
        animation = string.concat(
            '<head>'
                '<meta charset="UTF-8">'
                '<meta name="viewport" content="width=device-width, initial-scale=1.0">'
                '<title>Animation</title>'
                '<style>'
                    '* { box-sizing: border-box; }'
                    'html, body { width: 100vw; height: 100vh; margin: 0; }'
                '</style>'
            '</head>'
            '<body onload="startGame()">'
                '<script type="text/javascript">'
                    'let canvas=document.createElement("canvas"),context,svgDataType="data:image/svg+xml;base64,",carLeftImg=new Image;carLeftImg.src=svgDataType+"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIGlkPSJhIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIiB2aWV3Qm94PSIwIDAgNTAwIDUwMCI+PGRlZnM+PHN0eWxlPi5ie2ZpbGw6bm9uZTt9LmN7ZmlsbDojMDEwMTAxO30uZCwuZXtmaWxsOiNlYzIyMjc7fS5me2ZpbGw6I2ZlZmFkNzt9Lmd7ZmlsbDojMjMxZjIwO30uaHtmaWxsOiM0ZTRlNGU7fS5le3N0cm9rZTojMjMxZjIwO3N0cm9rZS1taXRlcmxpbWl0OjEwO308L3N0eWxlPjwvZGVmcz48cGF0aCBjbGFzcz0iYiIgZD0ibTQ1My40LDE2My45djE3Mi4xcy00MDQuNywwLTQwNC43LDB2LTE3Mi4xczQwNC43LDAsNDA0LjcsMFptLTIyLjYsNzguMWMyLjgtMTAxLjEtMTEyLjktNjkuNC0xNzguNC03Mi4zLTEwMC45LTE2LjktMjgwLjUsMTUuNS0xNzIuMiwxNDMuNCwzOS4zLDI4LjcsOTAuMyw2LjYsMTM1LjEsMTYuNyw3OC4zLTYsMjE2LjIsMjQuNywyMTYuOC02NS4yLjgsMTMuOC0xMi4yLDMxLjksNC43LDM5LjQsMzguMy0zMy41LTEyLjYtMTgzLTYtNjJaIi8+PHBhdGggY2xhc3M9ImMiIGQ9Im00MzAuOCwyNDIuMWMtNS45LTEyMC40LDQ0LjQsMjguMiw2LjIsNjEuNi0yMC05LjQsMS41LTMyLjItNi4yLTQ3LjktMS44LDE2LjYtMi4yLDM2LjEtMTIuNiw0OS44LTc2LjQsNTMuMy0xODIuOCw5LjgtMjcxLjEsMjEuMy04NywyMy42LTEzNi4yLTEwNi45LTU4LjQtMTQ3LjgsNjUuNS0yMi41LDE0MS45LTQuMywyMTEuMi05LjYsNTcuNy05LDEzNS43LTUsMTMwLjksNzIuNlptLTM0NC40LDc0LjFjNzAsMjYuNCwxNTMuMiw0LjQsMjI4LDExLjcsNTUsMTUuNSwxMjEtOC45LDExNS40LTc0LjIsMTEuMywxMy0xMy43LDQzLjgsOC40LDQ5LjIsMTUtMjAuMiwyMS4yLTEwOC4xLTYuNy0xMDQtNi45LDIuMiw3LDUwLjItMS40LDQzLjMsNS45LTU5LjktNTguMS04Ny41LTEwOS03Mi40LTc2LjgsOS0xNjIuMi0xNS0yMzQuNCwxMS44LDUuOS0xLjMsMTEuOC0yLjUsMTcuNC00LjYtNC40LDUuMi0xMy42LDEyLjctMTguMSwyMC4yLTExLjksMTAuNS0zMi45LDUuOS0zMi4yLDI3LjItNC4xLDMzLjgtNy4yLDY4LjcsMzIuMiw3Ni40LDEyLjIsMTQuNiwyOC45LDI0LjQuNCwxNS40Wm0tMjYtMTA5YzI5LjYtOS44LDIwLTguNSwzOS44LTI3LjYtMTguMSwxLjgtMzIsMTEtMzkuOCwyNy42Wm00MS4xLDExMS42Yy0xMS45LTEzLjMtMjQuMS0yMi42LTQxLjItMjguMyw5LjUsMTkuOCwyMSwyMy45LDQxLjIsMjguM1oiLz48cGF0aCBjbGFzcz0iZSIgZD0ibTg2LjUsMzE2LjJjMjguOSw4LjQsMTAuNi0xLS43LTE1LjYtMzgtMTYuNS0yOS41LTEwLTM0LjYtNTAuNy0uOC0zMy4zLDUuNS00MS44LDM0LjYtNTIuOSwxNy0zMi40LDIzLjQtMjcuNSw4OC4zLTI1LjUsNDcuNS00LjcsOTQuOS45LDE0Mi41LTEuMyw1My44LTE1LjMsMTE5LjksOS41LDExMy41LDc0LjEtMS45LTEyMy4zLDM5LjgsMTguMiw3LjksNTguNC0yMi4xLTUuNywyLjktMzUuNy04LjQtNDkuMiw0LjgsMTAwLjMtMTA0LjUsNzMuMS0xNjkuOCw3My44LTU2LjMtMy44LTEyMi44LDExLjUtMTczLjMtMTEuMVptMjc0LjctODIuOWM5LjEtODMuNC0xMDItNDguMS0xNTQuNC01Ni41LTYxLjYtOC4yLTQ4LjQsMTA4LjctMjcsMTQxLjEsMzcuMiwxMS4zLDgyLDEuMSwxMjEuMS0xLDcxLjcsMTAuMyw1OC0zMS42LDYwLjMtODMuNloiLz48cGF0aCBjbGFzcz0iZiIgZD0ibTYwLjUsMjA3LjJjNy43LTE2LjYsMjEuNy0yNS43LDM5LjctMjcuNS0xOS41LDE4LjktMTAuOSwxOC4zLTM5LjcsMjcuNVoiLz48cGF0aCBjbGFzcz0iZiIgZD0ibTEwMS42LDMxOC44Yy0yMC4yLTQuNC0zMS43LTguNS00MS4yLTI4LjMsMTcsNS42LDI5LjMsMTUuMSw0MS4yLDI4LjNaIi8+PHBhdGggY2xhc3M9ImMiIGQ9Im0zNjEuMSwyMzMuM2MtMS42LDUxLjgsMTAuNiw5My45LTYwLjIsODMuNC0zOS4xLDIuMS04My44LDEyLjItMTIxLjEsMS0yMS43LTM1LjItMzUuMS0xNTAuMiwyOS4yLTE0MS4zLDUxLjcsOC4yLDE2Mi4xLTI1LjYsMTUyLjEsNTYuOVptLTE1My4zLTUyLjJjOC4zLDUuOCw0NS0uNSwzNy4xLDEzLjMtMzYuOSw4NS41LDM1LjcsMTE3LjYtMjkuNiwxMjEuNi01Ni42LDEwLjQsNjMuOSwzLjgsODcuNS0uMiw1MC44LDcuOCw1OS42LTEyLjksNTcuMi01OS42LDYuNy00OC44LTguNC04Ny4zLTY0LjYtNzQuNC0yNi4xLTMuNi05Ny4yLTgtODcuNi0uN1ptLTQzLjYsNzMuNGMxLjUsNTQuMSw5LjksNzIuMyw2NS42LDUzLjIsMTEtMjkuNS0xMi02OS41LDQuNS0xMDYuMi40LTMuNiwyLjgtOS43LTIuNC0xMC41LTU4LjQtMjQuOC03MS41LDEwLjItNjcuNyw2My41Wm0xOS40LTc0LjVjMTMuOCw3LjgsNTYuMS0uNSw1MSwyMi0yNy40LDcxLjIsNDMuMywxMDguNy01MC41LDExNS42LDE4LjguOCw0Ni4yLTQuMSw2Mi41LTkuNy00Ni4xLTc1LjgsNTAuOC0xMzAuMS02My0xMjcuOVoiLz48cGF0aCBjbGFzcz0iZyIgZD0ibTIwNy44LDE4MS4yYy05LTguMiw2MS4yLTIuOCw4Ny41LjQsNTYtMTIuOCw3MS40LDI1LjUsNjQuNiw3NC40LDIuNCw0Ni43LTYuNCw2Ny40LTU3LjIsNTkuNi0yMy40LDQuNC0xNDQuMywxMC4yLTg3LjUuMiw2NC43LTMuMy03LTM5LDI5LjYtMTIxLjYsNy40LTEzLjctMjkuMy04LjEtMzctMTNaIi8+PHBhdGggY2xhc3M9ImgiIGQ9Im0xNjQuMiwyNTQuNmMxLjMtMjEuNi0yLjUtNzkuOCwzMC40LTcxLjEsMTIsNS4yLDQ0LjktLjMsNDAsMTguNC05LjUsMzcuMy03LjEsNjMuMiwxLDEwMC4xLDEuMSwzLjktMi41LDUuNy01LjgsNS45LTU2LjUsMTkuNS02MywwLTY1LjYtNTMuM1oiLz48cGF0aCBjbGFzcz0iZCIgZD0ibTE4My43LDE4MC4xYzExNC4xLTIuNSwxNi44LDUwLjMsNjMsMTI3LjctMTMuOSw1LjMtNDUuMywxMC42LTYyLjUsOS43LDkzLjctNi45LDIzLjEtNDQuNiw1MC41LTExNS42LDUuMS0yMi4zLTM3LjYtMTQuNi01MS0yMS44WiIvPjwvc3ZnPg==";let carRightImg=new Image;carRightImg.src=svgDataType+"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIGlkPSJhIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIiB2aWV3Qm94PSIwIDAgNTAwIDUwMCI+PGRlZnM+PHN0eWxlPi5ie2ZpbGw6bm9uZTt9LmMsLmR7ZmlsbDojZWIyMDI3O30uZXtmaWxsOiNmZGY5ZDY7fS5me2ZpbGw6IzIyMWYxZjt9Lmd7ZmlsbDojNGQ0ZTRlO30uZHtzdHJva2U6IzIyMWYxZjtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9PC9zdHlsZT48L2RlZnM+PHBhdGggY2xhc3M9ImIiIGQ9Im00Ni42LDMzNi4xdi0xNzIuMXM0MDQuNywwLDQwNC43LDB2MTcyLjFzLTQwNC43LDAtNDA0LjcsMFptMjIuNi03OC4xYy0yLjgsMTAxLjEsMTEyLjksNjkuNCwxNzguNCw3Mi4zLDEwMC45LDE2LjksMjgwLjUtMTUuNSwxNzIuMi0xNDMuNC0zOS4zLTI4LjctOTAuMy02LjYtMTM1LjEtMTYuNy03OC4zLDYtMjE2LjItMjQuNy0yMTYuOCw2NS4yLS44LTEzLjgsMTIuMi0zMS45LTQuNy0zOS40LTM4LjMsMzMuNSwxMi42LDE4Myw2LDYyWiIvPjxwYXRoIGQ9Im02OS4yLDI1Ny45YzUuOSwxMjAuNC00NC40LTI4LjItNi4yLTYxLjYsMjAsOS40LTEuNSwzMi4yLDYuMiw0Ny45LDEuOC0xNi42LDIuMi0zNi4xLDEyLjYtNDkuOCw3Ni40LTUzLjMsMTgyLjgtOS44LDI3MS4xLTIxLjMsODctMjMuNiwxMzYuMiwxMDYuOSw1OC40LDE0Ny44LTY1LjUsMjIuNS0xNDEuOSw0LjMtMjExLjIsOS42LTU3LjcsOS0xMzUuNyw1LTEzMC45LTcyLjZabTM0NC40LTc0LjFjLTcwLTI2LjQtMTUzLjItNC40LTIyOC0xMS43LTU1LTE1LjUtMTIxLDguOS0xMTUuNCw3NC4yLTExLjMtMTMsMTMuNy00My44LTguNC00OS4yLTE1LDIwLjItMjEuMiwxMDguMSw2LjcsMTA0LDYuOS0yLjItNy01MC4yLDEuNC00My4zLTUuOSw1OS45LDU4LjEsODcuNSwxMDksNzIuNCw3Ni44LTksMTYyLjIsMTUsMjM0LjQtMTEuOC01LjksMS4zLTExLjgsMi41LTE3LjQsNC42LDQuNC01LjIsMTMuNi0xMi43LDE4LjEtMjAuMiwxMS45LTEwLjUsMzIuOS01LjksMzIuMi0yNy4yLDQuMS0zMy44LDcuMi02OC43LTMyLjItNzYuNC0xMi4yLTE0LjYtMjguOS0yNC40LS40LTE1LjRabTI2LDEwOWMtMjkuNiw5LjgtMjAsOC41LTM5LjgsMjcuNiwxOC4xLTEuOCwzMi0xMSwzOS44LTI3LjZabS00MS4xLTExMS42YzExLjksMTMuMywyNC4xLDIyLjYsNDEuMiwyOC4zLTkuNS0xOS44LTIxLTIzLjktNDEuMi0yOC4zWiIvPjxwYXRoIGNsYXNzPSJkIiBkPSJtNDEzLjUsMTgzLjhjLTI4LjktOC40LTEwLjYsMSwuNywxNS42LDM4LDE2LjUsMjkuNSwxMCwzNC42LDUwLjcuOCwzMy4zLTUuNSw0MS44LTM0LjYsNTIuOS0xNywzMi40LTIzLjQsMjcuNS04OC4zLDI1LjUtNDcuNSw0LjctOTQuOS0uOS0xNDIuNSwxLjMtNTMuOCwxNS4zLTExOS45LTkuNS0xMTMuNS03NC4xLDEuOSwxMjMuMy0zOS44LTE4LjItNy45LTU4LjQsMjIuMSw1LjctMi45LDM1LjcsOC40LDQ5LjItNC44LTEwMC4zLDEwNC41LTczLjEsMTY5LjgtNzMuOCw1Ni4zLDMuOCwxMjIuOC0xMS41LDE3My4zLDExLjFabS0yNzQuNyw4Mi45Yy05LjEsODMuNCwxMDIsNDguMSwxNTQuNCw1Ni41LDYxLjYsOC4yLDQ4LjQtMTA4LjcsMjctMTQxLjEtMzcuMi0xMS4zLTgyLTEuMS0xMjEuMSwxLTcxLjctMTAuMy01OCwzMS42LTYwLjMsODMuNloiLz48cGF0aCBjbGFzcz0iZSIgZD0ibTQzOS41LDI5Mi44Yy03LjcsMTYuNi0yMS43LDI1LjctMzkuNywyNy41LDE5LjUtMTguOSwxMC45LTE4LjMsMzkuNy0yNy41WiIvPjxwYXRoIGNsYXNzPSJlIiBkPSJtMzk4LjQsMTgxLjJjMjAuMiw0LjQsMzEuNyw4LjUsNDEuMiwyOC4zLTE3LTUuNi0yOS4zLTE1LjEtNDEuMi0yOC4zWiIvPjxwYXRoIGQ9Im0xMzguOSwyNjYuN2MxLjYtNTEuOC0xMC42LTkzLjksNjAuMi04My40LDM5LjEtMi4xLDgzLjgtMTIuMiwxMjEuMS0xLDIxLjcsMzUuMiwzNS4xLDE1MC4yLTI5LjIsMTQxLjMtNTEuNy04LjItMTYyLjEsMjUuNi0xNTIuMS01Ni45Wm0xNTMuMyw1Mi4yYy04LjMtNS44LTQ1LC41LTM3LjEtMTMuMywzNi45LTg1LjUtMzUuNy0xMTcuNiwyOS42LTEyMS42LDU2LjYtMTAuNC02My45LTMuOC04Ny41LjItNTAuOC03LjgtNTkuNiwxMi45LTU3LjIsNTkuNi02LjcsNDguOCw4LjQsODcuMyw2NC42LDc0LjQsMjYuMSwzLjYsOTcuMiw4LDg3LjYuN1ptNDMuNi03My40Yy0xLjUtNTQuMS05LjktNzIuMy02NS42LTUzLjItMTEsMjkuNSwxMiw2OS41LTQuNSwxMDYuMi0uNCwzLjYtMi44LDkuNywyLjQsMTAuNSw1OC40LDI0LjgsNzEuNS0xMC4yLDY3LjctNjMuNVptLTE5LjQsNzQuNWMtMTMuOC03LjgtNTYuMS41LTUxLTIyLDI3LjQtNzEuMi00My4zLTEwOC43LDUwLjUtMTE1LjYtMTguOC0uOC00Ni4yLDQuMS02Mi41LDkuNyw0Ni4xLDc1LjgtNTAuOCwxMzAuMSw2MywxMjcuOVoiLz48cGF0aCBjbGFzcz0iZiIgZD0ibTI5Mi4yLDMxOC44YzksOC4yLTYxLjIsMi44LTg3LjUtLjQtNTYsMTIuOC03MS40LTI1LjUtNjQuNi03NC40LTIuNC00Ni43LDYuNC02Ny40LDU3LjItNTkuNiwyMy40LTQuNCwxNDQuMy0xMC4yLDg3LjUtLjItNjQuNywzLjMsNywzOS0yOS42LDEyMS42LTcuNCwxMy43LDI5LjMsOC4xLDM3LDEzWiIvPjxwYXRoIGNsYXNzPSJnIiBkPSJtMzM1LjgsMjQ1LjRjLTEuMywyMS42LDIuNSw3OS44LTMwLjQsNzEuMS0xMi01LjItNDQuOS4zLTQwLTE4LjQsOS41LTM3LjMsNy4xLTYzLjItMS0xMDAuMS0xLjEtMy45LDIuNS01LjcsNS44LTUuOSw1Ni41LTE5LjUsNjMsMCw2NS42LDUzLjNaIi8+PHBhdGggY2xhc3M9ImMiIGQ9Im0zMTYuMywzMTkuOWMtMTE0LjEsMi41LTE2LjgtNTAuMy02My0xMjcuNywxMy45LTUuMyw0NS4zLTEwLjYsNjIuNS05LjctOTMuNyw2LjktMjMuMSw0NC42LTUwLjUsMTE1LjYtNS4xLDIyLjMsMzcuNiwxNC42LDUxLDIxLjhaIi8+PC9zdmc+";let emptyTrackImg=new Image;emptyTrackImg.src=svgDataType+"PHN2ZyBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjUwMCIgaGVpZ2h0PSI1MDAiIHZpZXdCb3g9IjAgMCA1MDAgNTAwIj48cGF0aCBzdHlsZT0iZmlsbDojMzliNTRhIiBkPSJNLjIgMGg1MDB2NTAwSC4yeiIvPjwvc3ZnPg==";let straightTrackHorizontalImg=new Image;straightTrackHorizontalImg.src=svgDataType+"PHN2ZyBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjUwMCIgaGVpZ2h0PSI1MDAiIHZpZXdCb3g9IjAgMCA1MDAgNTAwIj48cGF0aCBzdHlsZT0iZmlsbDojMzliNTRhIiBkPSJNMCAwaDUwMHY1MDBIMHoiLz48cGF0aCBzdHlsZT0iZmlsbDojZmZmIiBkPSJNMCA3NWg1MDB2MzUwSDB6Ii8+PHBhdGggc3R5bGU9ImZpbGw6IzgwODI4NSIgZD0iTTAgMTAwaDUwMHYzMDBIMHoiLz48L3N2Zz4=";let straightTrackVerticalImg=new Image;straightTrackVerticalImg.src=svgDataType+"PHN2ZyBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjUwMCIgaGVpZ2h0PSI1MDAiIHZpZXdCb3g9IjAgMCA1MDAgNTAwIj48cGF0aCBzdHlsZT0iZmlsbDojMzliNTRhIiBkPSJNMCAwaDUwMHY1MDBIMHoiLz48cGF0aCBzdHlsZT0iZmlsbDojZmZmIiBkPSJNNzUgMGgzNTB2NTAwSDc1eiIvPjxwYXRoIHN0eWxlPSJmaWxsOiM4MDgyODUiIGQ9Ik0xMDAgMGgzMDB2NTAwSDEwMHoiLz48L3N2Zz4=";let curvedTrackTopLeftImg=new Image;curvedTrackTopLeftImg.src=svgDataType+"PHN2ZyBpZD0idXVpZC05OTk1ZjEyYy1lMzdkLTQ4N2EtYTI5Yi0zNzMyYWYzMDgwMGEiIGRhdGEtbmFtZT0iTGF5ZXIgMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIgdmlld0JveD0iMCAwIDUwMCA1MDAiPjxkZWZzPjxzdHlsZT4udXVpZC05Y2U2NGVkOC03MTk1LTQ0YjktOWIzNC1jZDJiNzZlYWIzZmN7ZmlsbDojMzliNTRhfTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJ1dWlkLTljZTY0ZWQ4LTcxOTUtNDRiOS05YjM0LWNkMmI3NmVhYjNmYyIgZD0iTTAgMGg1MDB2NTAwSDB6Ii8+PHBhdGggZD0iTTUwMCA3NUMyNjUuMyA3NSA3NSAyNjUuMyA3NSA1MDBoNDI1Vjc1WiIgc3R5bGU9ImZpbGw6I2ZmZiIvPjxwYXRoIGQ9Ik01MDAgNDAwVjEwMGMtMjIwLjkgMC00MDAgMTc5LjEtNDAwIDQwMGgzMDBjMC01NS4yIDQ0LjgtMTAwIDEwMC0xMDBaIiBzdHlsZT0iZmlsbDojODA4Mjg1Ii8+PHBhdGggY2xhc3M9InV1aWQtOWNlNjRlZDgtNzE5NS00NGI5LTliMzQtY2QyYjc2ZWFiM2ZjIiBkPSJNNDI1IDQ5OS45aDc1di03NS4xYy00MS40IDAtNzUgMzMuNi03NSA3NVoiLz48L3N2Zz4=";let curvedTrackTopRightImg=new Image;curvedTrackTopRightImg.src=svgDataType+"PHN2ZyBpZD0idXVpZC03NDFlMWU3ZC1kMWEwLTQ1MDQtODNkOS1iNTVmNGY2ZjY4ZDIiIGRhdGEtbmFtZT0iTGF5ZXIgMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIgdmlld0JveD0iMCAwIDUwMCA1MDAiPjxkZWZzPjxzdHlsZT4udXVpZC1hODM1YWQ4Ni1jN2ExLTQ5NDgtOGY1ZS1hNTNhYTc1YTU1MjZ7ZmlsbDojMzliNTRhfTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJ1dWlkLWE4MzVhZDg2LWM3YTEtNDk0OC04ZjVlLWE1M2FhNzVhNTUyNiIgZD0iTTAgMGg1MDB2NTAwSDB6Ii8+PHBhdGggZD0iTTQyNC45IDUwMEM0MjQuOSAyNjUuMyAyMzQuNiA3NSAwIDc1djQyNWg0MjVaIiBzdHlsZT0iZmlsbDojZmZmIi8+PHBhdGggZD0iTTk5LjkgNTAwaDMwMGMwLTIyMC45LTE3OS4xLTQwMC0zOTkuOS00MDB2MzAwYzU1LjIgMCAxMDAgNDQuOCAxMDAgMTAwWiIgc3R5bGU9ImZpbGw6IzgwODI4NSIvPjxwYXRoIGNsYXNzPSJ1dWlkLWE4MzVhZDg2LWM3YTEtNDk0OC04ZjVlLWE1M2FhNzVhNTUyNiIgZD0iTTAgNDI1djc1aDc1LjFjMC00MS40LTMzLjYtNzUtNzUtNzVaIi8+PC9zdmc+";let curvedTrackBottomLeftImg=new Image;curvedTrackBottomLeftImg.src=svgDataType+"PHN2ZyBpZD0idXVpZC0wYTcxMGQ2Mi05ZmY5LTQ3YzQtOWFlMC0zMTkxOTRlZTFiNWEiIGRhdGEtbmFtZT0iTGF5ZXIgMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIgdmlld0JveD0iMCAwIDUwMCA1MDAiPjxkZWZzPjxzdHlsZT4udXVpZC1kMmFhODQ5MC0xNjY4LTQ3YzItYTUzNy0yZDU3YzEzYTk1ZDl7ZmlsbDojMzliNTRhfTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJ1dWlkLWQyYWE4NDkwLTE2NjgtNDdjMi1hNTM3LTJkNTdjMTNhOTVkOSIgZD0iTTAgMGg1MDB2NTAwSDB6Ii8+PHBhdGggZD0iTTc1IDBjMCAyMzQuNyAxOTAuMyA0MjUgNDI1IDQyNVYwSDc1WiIgc3R5bGU9ImZpbGw6I2ZmZiIvPjxwYXRoIGQ9Ik00MDAgMEgxMDBjMCAyMjAuOSAxNzkuMSA0MDAgNDAwIDQwMFYxMDBjLTU1LjIgMC0xMDAtNDQuOC0xMDAtMTAwWiIgc3R5bGU9ImZpbGw6IzgwODI4NSIvPjxwYXRoIGNsYXNzPSJ1dWlkLWQyYWE4NDkwLTE2NjgtNDdjMi1hNTM3LTJkNTdjMTNhOTVkOSIgZD0iTTQ5OS45IDc1VjBoLTc1LjFjMCA0MS40IDMzLjYgNzUgNzUgNzVaIi8+PC9zdmc+";let curvedTrackBottomRightImg=new Image;curvedTrackBottomRightImg.src=svgDataType+"PHN2ZyBpZD0idXVpZC1hNjE3ZWZkMS0zNTgyLTQwN2YtODdjMi0wODQzOThmNDJlNzMiIGRhdGEtbmFtZT0iTGF5ZXIgMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIgdmlld0JveD0iMCAwIDUwMCA1MDAiPjxkZWZzPjxzdHlsZT4udXVpZC1iY2M1YTdiOS04NzZhLTRmMGQtYmUxNi03ODgzODdlZjgzMmJ7ZmlsbDojMzliNTRhfTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJ1dWlkLWJjYzVhN2I5LTg3NmEtNGYwZC1iZTE2LTc4ODM4N2VmODMyYiIgZD0iTTAgMGg1MDB2NTAwSDB6Ii8+PHBhdGggZD0iTTAgNDI1YzIzNC43IDAgNDI1LTE5MC4zIDQyNS00MjVIMHY0MjVaIiBzdHlsZT0iZmlsbDojZmZmIi8+PHBhdGggZD0iTTAgMTAwdjMwMGMyMjAuOSAwIDQwMC0xNzkuMSA0MDAtNDAwSDEwMGMwIDU1LjItNDQuOCAxMDAtMTAwIDEwMFoiIHN0eWxlPSJmaWxsOiM4MDgyODUiLz48cGF0aCBjbGFzcz0idXVpZC1iY2M1YTdiOS04NzZhLTRmMGQtYmUxNi03ODgzODdlZjgzMmIiIGQ9Ik03NSAuMUgwdjc1LjFjNDEuNCAwIDc1LTMzLjYgNzUtNzVaIi8+PC9zdmc+";let fps=60,time=0,gridNumRows=4,gridNumCols=4,gridCellSizeX,gridCellSizeY,carSizeX=40,carSizeY=40,trackOrder,trackIsLoop,currentTrackOrderId=0,currentTrackSegmentProgress=.5,currentTrackSegmentLength,distanceToNextCurve,lastLapTime=null,straightTopSpeed=30,curveTopSpeed=3,acceleration=3,braking=10,speed=0,lastX,lastY,velocityX,velocityY;function getGridIdToRowCol(M){return[Math.floor(M/gridNumCols),M%gridNumCols]}function getGridRowColToId(M,L){return L+M*gridNumCols}function startGame(){context=canvas.getContext("2d"),document.body.insertBefore(canvas,document.body.childNodes[0]),canvas.width=window.innerWidth,canvas.height=window.innerHeight,gridCellSizeX=canvas.width/gridNumCols,gridCellSizeY=canvas.height/gridNumRows,context.strokeStyle="rgba(0, 0, 0, 0)",generateTrack(),getTrackSegmentInfo();for(let M=0;M<trackOrder.length;M++)console.log(`Id ${trackOrder[M]} curve ${getTrackIsCurve(M)}`);runFrame()}function shuffle(M){let L=M.length,N;for(;0!=L;)N=Math.floor(Math.random()*L),L--,[M[L],M[N]]=[M[N],M[L]];return M}function generateTrack(){var M,L;let N=getGridRowColToId(0,0),i=getGridRowColToId(gridNumRows-1,gridNumCols-1);[trackOrder,trackIsLoop]=(M=N,[function M(L,N){if(L.visited.push(L.id),L.id===N)return L;let[i,T]=getGridIdToRowCol(L.id),t=[];for(let j=-1;j<=1;j++)for(let $=-1;$<=1;$++){if(0!=j&&0!=$||0==j&&0==$)continue;let u=i+j,I=T+$;if(u<0||u>=gridNumRows||I<0||I>=gridNumCols)continue;let e=getGridRowColToId(u,I);L.visited.includes(e)||t.push(e)}for(let D=0;D<t.length;D++){let g=M({id:t[D],visited:L.visited},N);if(null!=g)return g}return null}({id:M,visited:[]},L=i).visited,!1]),console.log(trackOrder)}function runFrame(){runPhysics(),draw(),time+=1/fps,setTimeout(function(){requestAnimationFrame(runFrame)},1e3/fps)}function getPrevCurrNextRowCols(M){let[L,N]=getGridIdToRowCol(trackOrder[(M+trackOrder.length-1)%trackOrder.length]),[i,T]=getGridIdToRowCol(trackOrder[M]),[t,j]=getGridIdToRowCol(trackOrder[(M+1)%trackOrder.length]);return trackIsLoop||(0==M?(L=i-1,N=T):M!=trackOrder.length-1||(t=i+1,j=T)),[L,N,i,T,t,j]}function getTrackIsCurve(M){let[L,N,i,T,t,j]=getPrevCurrNextRowCols(M);return(T!=N||T!=j||i==L||i==t)&&(T==N||T==j||i!=L||i!=t)}function getTrackDirection(M){let[L,N,i,T,t,j]=getPrevCurrNextRowCols(M);if(getTrackIsCurve(M))return T-1==N&&T==j&&i==L&&i+1==t||T==N&&T-1==j&&i+1==L&&i==t?"tr":T==N&&T+1==j&&i+1==L&&i==t||T+1==N&&T==j&&i==L&&i+1==t?"tl":T==N&&T+1==j&&i-1==L&&i==t||T+1==N&&T==j&&i==L&&i-1==t?"bl":"br";return i==t?"h":"v"}function getTrackSegmentInfo(){currentTrackSegmentLength=getTrackIsCurve(currentTrackOrderId)?100:2*Math.PI*50;let M=currentTrackOrderId;for(let L=0;L<trackOrder.length;L++){if(getTrackIsCurve(M)){distanceToNextCurve=100*L;break}M=(M+1)%trackOrder.length}}function runPhysics(){getTrackSegmentInfo();let M=!1;(M=!(speed<curveTopSpeed)&&((speed-curveTopSpeed)/braking>=0||curveTopSpeed<=Math.sqrt(Math.pow(speed,2)+2*braking*distanceToNextCurve)))?speed-=braking/fps:(0==distanceToNextCurve&&speed<curveTopSpeed||distanceToNextCurve>0&&speed<straightTopSpeed)&&(speed+=acceleration/fps),(currentTrackSegmentProgress+=speed/currentTrackSegmentLength)>=1&&(currentTrackSegmentProgress=0,++currentTrackOrderId>=trackOrder.length&&(currentTrackOrderId=0,lastLapTime=time,time=0))}function draw(){context.clearRect(0,0,canvas.width,canvas.height),context.fillStyle="black",context.fillRect(0,0,canvas.width,canvas.height),drawTrack(),drawCar(),drawTimer()}function drawTrack(){for(let M=0;M<gridNumRows;M++)for(let L=0;L<gridNumCols;L++)drawTrackTile(M,L)}function drawTrackTile(M,L){let N=L*gridCellSizeX,i=M*gridCellSizeY,T=getGridRowColToId(M,L);if(!trackOrder.includes(T)){context.drawImage(emptyTrackImg,N,i,gridCellSizeX,gridCellSizeY);return}let t=trackOrder.indexOf(T),j=getTrackDirection(t);"h"==j?context.drawImage(straightTrackHorizontalImg,N,i,gridCellSizeX,gridCellSizeY):"v"==j?context.drawImage(straightTrackVerticalImg,N,i,gridCellSizeX,gridCellSizeY):"tl"==j?context.drawImage(curvedTrackTopLeftImg,N,i,gridCellSizeX,gridCellSizeY):"tr"==j?context.drawImage(curvedTrackTopRightImg,N,i,gridCellSizeX,gridCellSizeY):"bl"==j?context.drawImage(curvedTrackBottomLeftImg,N,i,gridCellSizeX,gridCellSizeY):"br"==j&&context.drawImage(curvedTrackBottomRightImg,N,i,gridCellSizeX,gridCellSizeY)}function lerp(M,L,N){return M>L?L+(M-L)*(1-N):M+(L-M)*N}function getCarPosition(){let[M,L,N,i,T,t]=getPrevCurrNextRowCols(currentTrackOrderId),j=i*gridCellSizeX,$=N*gridCellSizeY,u=(i+1)*gridCellSizeX,I=(N+1)*gridCellSizeY,e=(j+u)/2,D=($+I)/2,g,w,c,r;g=i<L?u:i>L?j:e,w=N<M?I:N>M?$:D,c=i<t?u:i>t?j:e,r=N<T?I:N>T?$:D;let z,s;if(g!=c&&w!=r){let y,S,C,a;g==e&&w==I&&c==u&&r==D?(y=u,S=I,C=Math.PI,a=3*Math.PI/2):g==j&&w==D&&c==e&&r==I?(y=j,S=I,C=3*Math.PI/2,a=2*Math.PI):g==u&&w==D&&c==e&&r==$?(y=u,S=$,C=Math.PI/2,a=Math.PI):g==e&&w==$&&c==j&&r==D?(y=j,S=$,C=0,a=Math.PI/2):g==u&&w==D&&c==e&&r==I?(y=u,S=I,C=3*Math.PI/2,a=Math.PI):g==e&&w==I&&c==j&&r==D?(y=j,S=I,C=2*Math.PI,a=3*Math.PI/2):g==e&&w==$&&c==u&&r==D?(y=u,S=$,C=Math.PI,a=Math.PI/2):g==j&&w==D&&c==e&&r==$&&(y=j,S=$,C=Math.PI/2,a=0);let l=lerp(C,a,currentTrackSegmentProgress);z=y+Math.cos(l)*gridCellSizeX/2,s=S+Math.sin(l)*gridCellSizeY/2}else z=lerp(g,c,currentTrackSegmentProgress),s=lerp(w,r,currentTrackSegmentProgress);return(z!=lastX||s!=lastY)&&(velocityX=z-lastX,velocityY=s-lastY,lastX=z,lastY=s),[z,s]}function drawCar(){let[M,L]=getCarPosition(),N;N=Math.abs(velocityX)>=Math.abs(velocityY)?velocityX>=0?carRightImg:carLeftImg:velocityY>=0?carRightImg:carLeftImg,context.drawImage(N,M-carSizeX/2,L-carSizeY/2,carSizeX,carSizeY)}function drawTimer(){context.font="18px serif",context.textBaseline="hanging",context.fillStyle="rgb(255, 255, 0)",context.fillText("Time: "+time.toFixed(2)+"s"+(null!=lastLapTime?" | Last: "+lastLapTime.toFixed(2)+"s":""),10,20)}'
                '</script>'
            '</body>'
        );

        return animation;
    }
}
